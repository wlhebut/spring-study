<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ta.mapper.TeacherMapper">
    <select id="selectTeachers" resultType="Teacher">
      select * from teacher;
    </select>

    <!--
    一对多处理
    方式二：
    -->

    <select id="selectTeachers1" resultMap="selectTeachers1">
          SELECT
        t.id,
        t.`name` AS teacher_name,
        s.id AS student_id,
        s.`name` AS student_name,
        s.tid
    FROM
        teacher t
    LEFT JOIN student s ON t.id = s.tid
            <if test="id != null">
                WHERE
                t.id = #{id};
            </if>


    </select>

    <resultMap id="selectTeachers1" type="Teacher">
        <result property="id" column="id"/>
        <result property="name" column="teacher_name"/>
        <collection property="students" ofType="Student">
            <result property="id" column="student_id"/>
            <result property="name" column="student_name"/>
            <result property="tid" column="tid"/>
        </collection>
    </resultMap>

    <!--
    一对多处理
    方式二：
    -->

    <select id="selectTeachers2" resultMap="selectTeachers2">
      select id as teacher_id,`name` as teacher_name from teacher where id = #{id};
    </select>
    <resultMap id="selectTeachers2" type="Teacher">
        <result property="id" column="teacher_id"/>
        <result property="name" column="teacher_name"/>
        <collection property="students" javaType="ArrayList" ofType="Student" select="getStudentByTeacherId" column="teacher_id"/>
    </resultMap>

    <select id="getStudentByTeacherId" resultMap="teacherStudent">
        select id as student_id,`name`  as student_name,tid   from  student where tid = #{id};
    </select>

    <resultMap id="teacherStudent" type="Student" >
        <result property="id" column="student_id"/>
        <result property="name" column="student_name"/>
        <!--<result property="id" column="student_id"/>-->
    </resultMap>

</mapper>